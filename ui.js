const mainMenu=document.getElementById("menu");const difficultyMenu=document.getElementById("difficultyMenu");const pauseMenu=document.getElementById("pauseMenu");let diff="medium";const DIFF={easy:{base:260,min:90,gain:5,obsStart:10,obsPerScore:1,shrinkPer:6},medium:{base:220,min:70,gain:6,obsStart:15,obsPerScore:1,shrinkPer:5},hard:{base:180,min:60,gain:8,obsStart:20,obsPerScore:2,shrinkPer:4}};function getDiffSettings(){return DIFF[diff]}window.getDiffSettings=getDiffSettings;if(typeof stepMs==="function"){window.stepMs=function(){const s=getDiffSettings();const d=Math.min(score*s.gain,s.base-s.min);return s.base-d}}function showMain(){state="menu";mainMenu.style.display="flex";difficultyMenu.style.display="none";pauseMenu.style.display="none"}function openDiff(){mainMenu.style.display="none";difficultyMenu.style.display="flex"}function pause(){if(state!=="playing")return;state="paused";pauseMenu.style.display="flex"}function resume(){if(state!=="paused")return;state="playing";pauseMenu.style.display="none"}function startNewGame(){reset();mainMenu.style.display="none";difficultyMenu.style.display="none";pauseMenu.style.display="none";if(typeof startCountdown==="function"){startCountdown(3000)}else{state="playing"}}document.getElementById("startBtn")?.addEventListener("click",()=>{if(state==="menu"){startNewGame()}});document.getElementById("diffBtn")?.addEventListener("click",()=>{openDiff()});document.getElementById("resumeBtn")?.addEventListener("click",()=>{resume()});document.getElementById("quitBtn")?.addEventListener("click",()=>{showMain()});document.getElementById("easyBtn")?.addEventListener("click",()=>{diff="easy";showMain()});document.getElementById("mediumBtn")?.addEventListener("click",()=>{diff="medium";showMain()});document.getElementById("hardBtn")?.addEventListener("click",()=>{diff="hard";showMain()});document.getElementById("backMainBtn")?.addEventListener("click",()=>{showMain()});document.addEventListener("keydown",e=>{if(e.key==="Escape"){if(state==="playing")pause();else if(state==="paused")resume()}else if(e.key==="Enter"){if(state==="menu"||state==="over"){startNewGame()}}});showMain();
